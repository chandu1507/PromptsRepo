---
mode: agent
description: Security vulnerability remediation planning for Azure DevOps work items
---

## CONTEXT

You are addressing a security vulnerability reported via Azure DevOps originating from security/pentest review.

Use MCP ticket data if available.

---

## TECHNOLOGY CONTEXT

Auto-detect stack from repo.

Optional override:

STACK_OVERRIDE:
{{optional_stack}}

---

## OBJECTIVE

Produce a secure remediation plan that:

- Eliminates vulnerability
- Prevents regression
- Minimizes blast radius
- Maintains functionality
- Adds monitoring evidence

---

## STEP 1 — VULNERABILITY UNDERSTANDING

Extract:

### Vulnerability Type
(Map to OWASP or known class)

### Attack Vector

### Exploit Scenario

### Affected Assets

### Severity Interpretation

Explain in engineering terms.

---

## STEP 2 — ROOT CAUSE ANALYSIS

Identify:

- Code cause
- Config cause
- Infra cause
- Dependency cause
- Process cause

List exact locations.

---

## STEP 3 — IMPACT ANALYSIS

Determine:

- Data exposure risk
- Privilege escalation risk
- Lateral movement risk
- Service disruption risk
- Compliance impact

---

## STEP 4 — REMEDIATION OPTIONS

Provide multiple fixes:

For each:

- Approach
- Security strength
- Complexity
- Side effects
- Performance impact

Recommend safest viable fix.

---

## STEP 5 — IMPLEMENTATION PLAN

Atomic remediation steps:

Each step:

- Files/config touched
- Security goal
- Verification

---

## STEP 6 — DEFENSE IN DEPTH

Recommend:

- Additional safeguards
- Validation layers
- Monitoring
- Alerts
- Rate limits
- Logging

---

## STEP 7 — TEST STRATEGY

Define:

### Security Tests
### Regression Tests
### Abuse Cases
### Negative Cases

Include automated + manual.

---

## STEP 8 — DEPLOYMENT SAFETY

Address:

- Backward compatibility
- Migration
- Secrets rotation
- Token/session invalidation

---

## STEP 9 — VERIFICATION

Define how cyber team confirms fix.

---

## STEP 10 — PR OUTPUT

Generate PR description including:

- Vulnerability summary
- Fix explanation
- Risk reduction
- Tests
- Evidence

---

## OUTPUT DELIVERY MODE

Write markdown files under:

docs/security/{{workitem-id}}/

Files:

- vulnerability-summary.md
- root-cause.md
- remediation-plan.md
- defense-in-depth.md
- tests.md
- rollout.md
- pr-draft.md

Chat:

- short summary
- file list
- next step

---

## CONSTRAINTS

- Never weaken security
- Prefer least privilege
- Avoid breaking production
- No fake security fixes
- No security theater
